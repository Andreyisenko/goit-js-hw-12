{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// console.log(65);\nexport default createMarkup\n\n\nfunction createMarkup(arr) {\n    return arr\n      .map(\n        ({\n          id,\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `<li data-id=\"${id}\" class=\"gallery-item\">\n              <a href=${largeImageURL} class=\"gallery-link\">\n              <img src=${webformatURL} class=\"gallery-image\" alt=${tags}> \n              <div class=\"wrap\"><h2 class=\"title-like\">Likes <span class=\"span-text\"> ${likes} </span></h2>\n               <h2 class=\"title-views\">Views <span class=\"span-text\"> ${views} </span></h2>\n               <h2 class=\"title-comments\">Comments <span class=\"span-text\">${comments}</span> </h2>\n               <h2 class=\"title-downloads\">Downloads <span class=\"span-text\">${downloads} </span></h2></div>\n  </a>\n              </li>`\n      )\n      .join('');\n  }\n\n","// console.log(100);\nimport axios from 'axios';\nimport createMarkup from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nconst loadMoreBtn = document.querySelector('.load-more');\nconst gallerY = document.querySelector('.gallery');\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '47413156-c8c9abea8f6d88937b7892740';\nconst forM = document.querySelector('.feedback-form');\nlet spn = document.querySelector('.loader');\nlet page = 1;\nlet totalHitsData;\nlet qData;\n\nforM.addEventListener('submit', handleSubmit);\n\nfunction handleSubmit(event) {\n  page = 1;\n  spn.classList.add('is-hidden');\n  event.preventDefault();\n  qData = event.currentTarget.elements.photo.value.trim();\n  event.target.reset();\n  if (qData === '') {\n    iziToast.show({\n      color: 'red',\n      position: 'topRight',\n      message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    });\n    spn.classList.remove('is-hidden');\n    return;\n  }\n  \n  async function searchData() {\n    loadMoreBtn.addEventListener('click', onLoadMore);\n    const params = new URLSearchParams({\n      key: API_KEY,\n\n      q: qData,\n      page,\n      per_page: 15,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n    });\n    const { data } = await axios(`${BASE_URL}?${params}`);\n    return data;\n  }\n  searchData(qData)\n    .then(data => {\n      totalHitsData = data.totalHits;\n\n      if (!data.hits.length) {\n        iziToast.show({\n          color: 'red',\n          position: 'topRight',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n\n        loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n        gallerY.innerHTML = '';\n        spn.classList.remove('is-hidden');\n        return;\n      }\n\n      gallerY.innerHTML = '';\n      gallerY.insertAdjacentHTML('afterbegin', createMarkup(data.hits));\n      spn.classList.remove('is-hidden');\n      if (gallerY.children.length < data.totalHits) {\n        loadMoreBtn.classList.replace('load-more-hidden', 'load-more');\n      }\n      if (gallerY.children.length >= totalHitsData) {\n        loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n      }\n\n      lightbox.refresh();\n    })\n    .catch(error => {\n      iziToast.show({\n        color: 'red',\n        position: 'topRight',\n        message: `${error.massage}`,\n      });\n      gallerY.innerHTML = '';\n      spn.classList.remove('is-hidden');\n      return;\n    });\n    \n  async function onLoadMore() {\n    page += 1;\n\n    loadMoreBtn.disabled = true;\n\n    try {\n      spn.classList.remove('is-hidden');\n      const data = await searchData(page);\n\n      gallerY.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n\n      if (gallerY.children.length >= data.totalHits) {\n        iziToast.show({\n          color: 'blue',\n          position: 'topRight',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n        loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n      }\n      const card = document.querySelector('.gallery-item');\n      const cardHeight = card.getBoundingClientRect().height;\n      window.scrollBy({\n        left: 0,\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n\n      lightbox.refresh();\n    } catch (error) {\n      iziToast.show({\n        color: 'red',\n        position: 'center',\n        message: `${error.message}`,\n      });\n      console.log(error.message);\n\n      spn.classList.remove('is-hidden');\n    } finally {\n      forM.reset();\n      loadMoreBtn.disabled = false;\n    }\n  }\n}\n// loadMoreBtn.addEventListener('click', onLoadMore);"],"names":["createMarkup","arr","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","loadMoreBtn","gallerY","BASE_URL","API_KEY","forM","spn","page","totalHitsData","qData","handleSubmit","event","iziToast","searchData","onLoadMore","params","data","axios","error","cardHeight"],"mappings":"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"}